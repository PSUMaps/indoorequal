# barrier values , see https://taginfo.openstreetmap.org/keys/barrier#values
def_barrier_linestring: &barrier_linestring
  - wall
  - fence
  - gate

def_barrier_point: &barrier_point
  - gate
  - turnstile
  - lift_gate

def_barrier_fields: &barrier_fields
    - name: osm_id
      type: id
    - name: class
      type: mapping_value
    - name: geometry
      type: geometry
    - name: level
      key: level
      type: string
    - name: repeat_on
      key: repeat_on

tables:

  # etldoc: imposm3 -> osm_barrier_linestring
  barrier_linestring:
    type: linestring
    filters:
      require:
        level: [__any__]
      require_regexp:
        level: '^-?\d+\.?\d*([;-]-?\d+\.?\d*)*$'
    fields: *barrier_fields
    mapping:
      barrier: *barrier_linestring

  # etldoc: imposm3 -> osm_barrier_point
  barrier_point:
    type: point
    filters:
      require:
        level: [__any__]
      require_regexp:
        level: '^-?\d+\.?\d*([;-]-?\d+\.?\d*)*$'
    fields: *barrier_fields
    mapping:
      barrier: *barrier_point
